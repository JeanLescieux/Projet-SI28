<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MSN</title>
    <link rel="stylesheet" href="https://unpkg.com/98.css">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="window" style="width: 1200px;height:600px;background-color: whitesmoke;">
        <div class="title-bar">
            <div class="title-bar-text">MSN - Discussion</div>
            <div style="color: white;"><strong>@Pierre</strong></div>
            <div class="title-bar-controls">
                <button aria-label="Minimize"></button>
                <button aria-label="Maximize"></button>
                <button aria-label="Close" onclick="parent.closeMSN()"></button>
            </div>
        </div>

        <section class="nav">
            <button id="deconnexion-btn" class="déconnect">Se déconnecter</button>
        </section>

        <div class="content">
            <div class="table-container">
                <div class="container">

                    <div classe="side-left" style="margin-right: 90px;">
                        <ul class="tree-view" style="height: 90%; width: 300px;">
                            <aside class="groupes">
                                <h3>Conversations</h3>
                                <ul class="liste">
                                    <!--<li><img src="../../../../images/write_yellow-1.png" alt="message" class="img"><a href="#" class="conv" type-conversation="Conversation/Groupe_discussion_large.txt">   Groupe discussion large</a></li>-->
                                    <!--<li><img src="../../../../images/write_yellow-1.png" alt="message" class="img" ><a href="#" class="conv" type-conversation="Conversation/Groupe_des_12.txt">   Groupe des 12</a></li>-->
                                    <li><img src="../../../../images/write_yellow-1.png" alt="message" class="img"><a
                                            href="#" class="conv" type-conversation="Conversation/Thomas.txt">
                                            Thomas</a></li>
                                    <!--<li><img src="../../../../images/write_yellow-1.png" alt="message" class="img" ><a href="#" class="conv" type-conversation="Conversation/Nicolas.txt">   Nicolas</a></li>-->
                                    <!--<li><img src="../../../../images/write_yellow-1.png" alt="message" class="img" ><a href="#" class="conv" type-conversation="Conversation/Groupe_de_5_personnes.txt">   Groupe de 5 personnes</a></li>-->
                                    <li><img src="../../../../images/write_yellow-1.png" alt="message" class="img"><a
                                            href="#" class="conv" type-conversation="Conversation/Maman.txt"> Maman</a>
                                    </li>
                                    <li><img src="../../../../images/write_yellow-1.png" alt="message" class="img"><a
                                            href="#" class="conv" type-conversation="Conversation/Ami.txt"> Pierre</a>
                                    </li>
                                    <!--<li><img src="../../../../images/write_yellow-1.png" alt="message" class="img" ><a href="#" class="conv" type-conversation="Conversation/Thomas_Nicolas.txt">   Thomas - Nicolas</a></li>-->

                                </ul>
                            </aside>
                        </ul>

                    </div>

                    <div class="side-right">
                        <p class="titre"><strong></strong></p>
                        <ul class="tree-view chat-fenetre" style="height: 71%; width: 750px;"></ul>

                        <form action="" id="message-form" class="envoi-msg">
                            <input type="text" placeholder="Écrire un message ...">
                            <button id="send">Envoyer</button>
                        </form>

                        <div id="custom-alert" class="window custom-alert hidden" style="width: 300px">
                            <div class="title-bar">
                              <div class="title-bar-text">Erreur</div>
                              <div class="title-bar-controls">
                                <button aria-label="Close" onclick="closebtn()"></button>
                              </div>
                            </div>
                            <div class="window-body custom-alert-content">
                                <p><img src="../../../../images/msg_error-0.png" alt="logo erreur" class="imgErr"> Vous ne pouvez pas envoyer de message.</p>
                            </div>
                        </div>

                        <script>
                            document.querySelectorAll('.conv').forEach(conv => {
                                conv.addEventListener('click', function () {
                                    document.querySelectorAll('.conv').forEach(c => c.classList.remove('conv-active'));
                                    this.classList.add('conv-active');

                                    const sendMsgMom = localStorage.getItem('sendMsgMom') === 'true';
                                    const messageInput = document.querySelector('#message-form input[type="text"]');
                                    const messageForm = document.getElementById('send');
                                    const activeConversation = this.getAttribute('type-conversation'); // Sélectionnez la conversation active

                                    if (sendMsgMom && activeConversation === "Conversation/Maman.txt") {
                                        messageInput.value = "Votre fils se trouve ici : 48.667506; 2.245672";

                                        messageForm.addEventListener('click', function (event) {
                                            event.preventDefault();
                                            window.top.location.href = './momm.html';
                                        }, { once: true }); // Ajoutez { once: true } pour que cet écouteur ne s'exécute qu'une seule fois
                                    } else {
                                        resetMessageInput();
                                        disableSendButton();

                                    }
                                });
                            });

                            function resetMessageInput() {
                                const messageInput = document.querySelector('#message-form input[type="text"]');
                                messageInput.value = ""; // Réinitialisez la valeur de l'input texte
                            }
                            function disableSendButton() {
                                const messageForm = document.getElementById('send');
                                messageForm.addEventListener('click', function (event) {
                                    event.cancelable();
                                }, { once: true }); // Ajoutez { once: true } pour que cet écouteur ne s'exécute qu'une seule fois
                            }
                        </script>
                    </div>
                </div>
            </div>
        </div>




    </div>
</body>
<script src="msn.js"></script>

</html>